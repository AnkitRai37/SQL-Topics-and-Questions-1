PHASE-1
Q-1,
create table Employees(
Emp_id int primary key,
Emp_name varchar(100),
Department varchar(50),
salary int,
joining_date date
);

Q-2,
insert into employees(emp_id,emp_name,department,salary,joining_date)
values
(101,'Ankit Rai','IT',55000,'2024-07-01');

Q-3,
create table projects(
project_id int primary key,
project_name varchar(100),
start_date date,
end_date date,
Emp_id int,
constraint fk_emp foreign key (Emp_id) references Employees(Emp_id)
);

Q-4,
select emp_id,emp_name,department
from employees where department = 'IT';

Q-5,
select emp_name,emp_id,salary
from employees order by salary desc limit 3;

Q-6,
select e.emp_name,e.emp_id,p.project_name,p.project_id
from employees e 
join projects p 
on e.emp_id = p.emp_id;

Q-7,
update employees 
set salary = 60000
where emp_id = 101;

Q-8,
update employees
set salary = salary * 1.10
where department = 'HR';

Q-9,
update employees
set department = 'Sales'
where emp_id = 105;

Q-10,
delete from projects
where emp_id not in
(select emp_id from projects);

PHASE-2
Q-1,
select emp_name, hire_date
from employee
where hire_date>'2025-01-01';

Q-2,
select emp_id, emp_name,salary
from employee
where salary between 50000 and 60000;

Q-3,
select emp_name
from employee
where emp_name like 'A%';

Q-4,
select dept_id, 
count(*) as total_emp from employee
group by dept_id; 

Q-5,
select max(salary) as highestsalary
from employee
where dept_id = 103;

Q-6,
select emp_name
from employee
where email is null;

Q-7,
select emp_name, hire_date 
from employee where extract (year from hire_date) = 2025;

Q-8,
select avg( salary) as avgsalary from employee
group by dept_id;

Q-9,
select emp_name
from employee
where emp_name like '%a';

Q-10,
select emp_name , salary
from employee
order by  salary  desc limit 5;

PHASE-3,
Q-1,
select name, salary from employee 
where salary > 50000;

Q-2,
select name ,salary from employee
where salary between 30000 and 60000;

Q-3,
select name from employee
where name like 'A%';

 Q-4,
select name from employee 
where department is NULL;

Q-5,
select name,department,salary 
from employee 
where department = 'HR' and salary > 40000;

 Q-6,
select department,
count(*) as total_emp 
from employee
group by department;

Q-7,
select department,
avg(salary) as avg_salary
from employee 
group by department
having avg(salary) > 45000;

Q-8,
select name , salary 
from employee order by salary
desc;

Q-9,
select * from employee
where department 
in ('HR','Finance','IT');

Q-10,
select name, hire_date
from employee
where hire_date < '2020-10-10';

String and Substring

Q-1,
select upper(name) as customer_name from customer;

Q-2,
select lower(name) as customer_name from customer;

Q-3,
select length(name) from customer;

Q-4,
select substring(email,1,5) from customer;

Q-5,
select right(city,3) from customer;

Q-6,
select concat(name,' ',city) from customer;

Q-7,
select concat_ws('-',name,email,city) from customer;

Q-8,
select name from customer
where name  like 'A%';

Q-9,
select name , email from customer
where email like '%example%';

Q-10,
select replace
(email, 'example.com',
'company.com') as replace_email
from customer;

Q-11,
select trim(both from name)
from customer;

Q-12,
select email,substring
(email from position
('@' in email)+1) 
from customer;

Q-13,
select name from customer
where length(name) = 10;

Q-14,
select name, left(name,position
(' 'in name)-1) as first_name from customer;

Q-15,
 select name,
       substring(name from position
	   (' ' in name)+1) as surname
from customer;

Q-16,
select name from customer
where substring(name,2,1) = 'r';

Q-17,
select count(*) from customer
where email like '%.com';

Q-18,
select replace(name,'a','@') from customer;

Q-19,
select concat(substring(from position(' ' in name)+1), ', ', 
left(name, position(' ' in name)-1)) as formatted_namefrom
from customers;

Q-20,
select city from customer
where city like '%pur';

Phase-4, Alter and Cases

Q-1,
alter table employees add bonus int;

Q-2,
alter table employees rename column salary to base_salary;

Q-3,
alter table employees drop column hire_date;

Q-4,
alter table employees alter column bonus type decimal(10,2);

Q-5,
select name,
       case when base_salary > 50000 then 'high'
            else 'low' end as salary_category
from employees;

Q-6,
select name,
       case when department is null then 'unassigned'
            else department end as dept_label
from employees;

Q-7,
alter table employees add experience_level varchar(20);

Q-8,
update employees
set experience_level = case
    when hire_date < '2018-01-01' then 'senior'
    else 'junior'
end;

Q-9,
select name, base_salary,
       case when base_salary > 50000 then base_salary*0.20
            else base_salary*0.10 end as tax
from employees;

Q-10.
select name,
       case department
            when 'it' then 'tech team'
            when 'hr' then 'support team'
            when 'finance' then 'money team'
            else 'other'
       end as dept_group
from employees;

Q-11,
alter table employees
add constraint salary_check check (base_salary > 0);

Q-12,
alter table employees
alter column bonus set default 5000;

Q-13,
select name,
       case when hire_date < '2020-01-01' then 'old employee'
            else 'new employee' end as status
from employees;

Q-14,
alter table employees
add dept_id int,
add constraint fk_dept foreign key (dept_id) references departments(dept_id);

Q-15,
alter table employees drop constraint salary_check;

Q-16,
select case when base_salary > 50000 then 'high' else 'low' end as category,
       count(*) as count_emp
from employees
group by category;

Q-17,
select name, base_salary,
       case department
            when 'it' then base_salary*0.15
            when 'hr' then base_salary*0.10
            when 'finance' then base_salary*0.20
            else base_salary*0.05
       end as perf_bonus
from employees;

Q-18,
select name, city,
       case
            when city in ('lucknow','delhi') then 'north'
            when city in ('mumbai','pune') then 'west'
            else 'other'
       end as city_group
from employees;

Q-19,
alter table employees rename to staff;

Q-20,
select name, base_salary,
       case when base_salary > 50000 then 'high' else 'low' end as salary_category
from staff
order by salary_category desc;

Phase-5

Q-1,
select e.name,d.dept_name
from employees e
join departments d on 
e.dept_id = d.dept_id;

Q-2,
select e.name,d.dept_name
from employees e
left join departments d on 
e.dept_id = d.dept_id;

Q-3,
select d.dept_name
from departments d
left join employees e on 
d.dept_id = e.dept_id
where e.employee_id is null;

Q-4,
select d.dept_name, 
count(e.employee_id) as emp_count
from departments d
left join employees e on d.dept_id = e.dept_id
group by d.dept_name;

Q-5,
select e.name , e.salary,d.dept_name
from employees e join
departments d on
e.dept_id = d. dept_id
where e. salary > 50000;

Q-6,
select e.name, d.dept_name,e.hire_date
from employees e join departments d
on e.dept_id = d.dept_id
where e.hire_date < '2020-01-01';

Q-7,
select d.dept_name, avg(e.salary) as avg_salary
from departments d
join employees e on d.dept_id = e.dept_id
group by d.dept_name;

Q-8,
select name
from employees
where dept_id is null;

Q-9,
select e.name, d.dept_name
from employees e left join
departments d on e.dept_id = d.dept_id
order by d.dept_name;

Q-10,
select d.dept_name, e.name, e.salary
from departments d join employees e
on d.dept_id = e.dept_id
where e.salary = (select max(salary)
from employees where
dept_id = d.dept_id);



